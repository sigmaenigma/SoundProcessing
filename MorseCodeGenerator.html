<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Morse Code Converter</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
<script>
// Define Morse code mappings
const morseCodeMap = {
    'A': '.-', 'B': '-...', 'C': '-.-.', 'D': '-..', 'E': '.', 'F': '..-.', 'G': '--.', 'H': '....', 'I': '..', 'J': '.---',
    'K': '-.-', 'L': '.-..', 'M': '--', 'N': '-.', 'O': '---', 'P': '.--.', 'Q': '--.-', 'R': '.-.', 'S': '...', 'T': '-',
    'U': '..-', 'V': '...-', 'W': '.--', 'X': '-..-', 'Y': '-.--', 'Z': '--..',
    '0': '-----', '1': '.----', '2': '..---', '3': '...--', '4': '....-', '5': '.....',
    '6': '-....', '7': '--...', '8': '---..', '9': '----.',
    ' ': '/'
};

// Reverse Morse code mappings to convert from Morse to text
const reverseMorseCodeMap = Object.fromEntries(
    Object.entries(morseCodeMap).map(([key, value]) => [value, key])
);

// Function to convert text to Morse code
function convertToMorse(text) {
    return text.toUpperCase().split('').map(char => morseCodeMap[char] || '').join(' ');
}

// Function to convert Morse code to text
function convertToText(morseCode) {
    return morseCode.split(' ').map(code => reverseMorseCodeMap[code] || '').join('');
}

// Function to handle conversion to Morse code
function handleConversionToMorse() {
    const inputText = document.getElementById('inputText').value;
    const morseCode = convertToMorse(inputText);
    document.getElementById('outputMorse').textContent = morseCode;
    document.getElementById('outputMorse').style.display = 'block'; // Show the alert
    document.getElementById('copyMorseButton').style.display = 'block'; // Show the copy button
    document.getElementById('playMorseButton').style.display = 'block'; // Show the play button
    document.getElementById('playMorseButton').textContent = 'Play';
    document.getElementById('playMorseButton').onclick = () => playMorseCode(morseCode);
}

// Function to play Morse code as tones
function playMorseCode(morseCode) {
    const audioContext = new AudioContext();
    const oscillator = audioContext.createOscillator();
    const gainNode = audioContext.createGain();
    oscillator.connect(gainNode);
    gainNode.connect(audioContext.destination);

    const dotDuration = 100; // Duration of a dot (in milliseconds)
    const dashDuration = dotDuration * 3; // Duration of a dash (in milliseconds)
    const interSymbolDelay = dotDuration; // Delay between symbols (in milliseconds)
    const interCharacterDelay = dotDuration * 3; // Delay between characters (in milliseconds)

    let time = audioContext.currentTime;

    for (const symbol of morseCode) {
        switch (symbol) {
            case '.':
                oscillator.frequency.setValueAtTime(1000, time);
                gainNode.gain.setValueAtTime(1, time);
                time += dotDuration / 1000;
                gainNode.gain.setValueAtTime(0, time);
                break;
            case '-':
                oscillator.frequency.setValueAtTime(1000, time);
                gainNode.gain.setValueAtTime(1, time);
                time += dashDuration / 1000;
                gainNode.gain.setValueAtTime(0, time);
                break;
            case ' ':
                time += interCharacterDelay / 1000;
                break;
        }
        time += interSymbolDelay / 1000;
    }

    oscillator.start();
    oscillator.stop(time);

    // Change button text to "Playing"
    const playButton = document.getElementById('playMorseButton');
    playButton.textContent = 'Playing';
    playButton.onclick = () => pauseMorseCode(oscillator);
}

// Function to pause Morse code tones
function pauseMorseCode(oscillator) {
    oscillator.stop();
    const playButton = document.getElementById('playMorseButton');
    playButton.textContent = 'Play';
    playButton.onclick = () => playMorseCode(oscillator);
}

// Function to handle conversion to text
function handleConversionToText() {
    const inputMorse = document.getElementById('inputMorse').value;
    const text = convertToText(inputMorse);
    document.getElementById('outputText').textContent = text;
    document.getElementById('outputText').style.display = 'block'; // Show the alert
    document.getElementById('copyTextButton').style.display = 'block'; // Show the copy button
}

// Function to copy the output text
function copyOutputText(elementId) {
    const outputElement = document.getElementById(elementId);
    const textToCopy = outputElement.textContent;
    navigator.clipboard.writeText(textToCopy.trim()) // Trim to remove leading/trailing spaces
        .then(() => {
            alert('Text copied to clipboard');
        })
        .catch(err => {
            console.error('Failed to copy text: ', err);
        });
}

// Function to reset the page
function resetPage() {
    location.reload();
}
</script>
</head>
<body>
<div>
    <h3>Convert Text to Morse Code</h3>
    <form>
        <label for="inputText">Enter text:</label><br>
        <input type="text" id="inputText" name="inputText"><br><br>
        <button type="button" class="btn btn-primary btn-lg" onclick="handleConversionToMorse()"><i class="bi bi-gear-wide-connected"></i> Convert to Morse Code</button>
        <div id="outputMorse" class="alert alert-success" role="alert" style="display: none;">    
            <!-- Initially hidden -->
        </div>
        <button id="copyMorseButton" type="button" class="btn btn-secondary btn-lg" onclick="copyOutputText('outputMorse')" style="display: none;"><i class="bi bi-copy"></i> Copy Morse Code</button>
        <br>
		<button id="playMorseButton" type="button" class="btn btn-secondary btn-lg" style="display: none;"><i class="bi bi-play-circle"></i> Play</button>
    </form>
</div>
<hr>
<div>
    <h3>Convert Morse Code to Text</h3>
    <form>
        <label for="inputMorse">Enter Morse code:</label><br>
        <input type="text" id="inputMorse" name="inputMorse"><br><br>
        <button type="button" class="btn btn-primary btn-lg" onclick="handleConversionToText()"><i class="bi bi-card-text"></i> Convert to Text</button>
        <div id="outputText" class="alert alert-success" role="alert" style="display: none;">    
            <!-- Initially hidden -->
        </div>
        <button id="copyTextButton" type="button" class="btn btn-secondary btn-lg" onclick="copyOutputText('outputText')" style="display: none;"><i class="bi bi-copy"></i> Copy Text</button>
    </form>
</div>
<hr>
<button type="button" class="btn btn-danger" onclick="resetPage()">Clear/Refresh</button>
</body>
</html>
